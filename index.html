<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sala de Cultura de Células e Tecidos - Agendamento</title>
  <style>
    /* CSS styles go here */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    
    header {
      background-color: #333;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    
    main {
      padding: 20px;
    }
    
    #calendar {
      width: 100%;
      border-collapse: collapse;
    }
    
    #calendar th, #calendar td {
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
    }
    
    #calendar th {
      background-color: #f2f2f2;
    }
    
    #calendar td {
      height: 100px;
      vertical-align: top;
    }
    
    .event {
      background-color: #4CAF50;
      color: #fff;
      padding: 5px;
      margin-bottom: 5px;
      cursor: pointer;
    }
    
    .request-form {
      margin-top: 20px;
    }
    
    .request-form input, .request-form textarea {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 5px;
    }
    
    #event-details {
      margin-top: 20px;
      border: 1px solid #ddd;
      padding: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Sala de Cultura de Células e Tecidos - Agendamento</h1>
  </header>
  
  <main>
    <h2>Calendário de Agendamentos</h2>
    <table id="calendar">
      <thead>
        <tr>
          <th>Domingo</th>
          <th>Segunda</th>
          <th>Terça</th>
          <th>Quarta</th>
          <th>Quinta</th>
          <th>Sexta</th>
          <th>Sábado</th>
        </tr>
      </thead>
      <tbody id="calendar-body">
        <!-- Calendar events will be dynamically generated here -->
      </tbody>
    </table>
    
    <h2>Solicitar Novo Agendamento</h2>
    <div class="request-form">
      <input type="text" id="request-date" placeholder="Data (AAAA-MM-DD)">
      <input type="text" id="request-start-time" placeholder="Horário de Início (HH:MM)">
      <input type="text" id="request-end-time" placeholder="Horário de Término (HH:MM)">
      <input type="text" id="request-responsible" placeholder="Nome do Responsável">
      <textarea id="request-description" placeholder="Descrição do Evento"></textarea>
      <button onclick="requestNewEvent()">Solicitar Agendamento</button>
    </div>
    
    <h2>Detalhes do Agendamento</h2>
    <div id="event-details">
      <p id="event-date"></p>
      <p id="event-start-time"></p>
      <p id="event-end-time"></p>
      <p id="event-responsible"></p>
      <p id="event-description"></p>
    </div>
  </main>
  
  <script>
    // Sample event data
    let events = [
      {
        date: "2024-07-23",
        startTime: "09:00",
        endTime: "12:00",
        responsible: "João Silva",
        description: "Experimentos com células-tronco"
      },
      {
        date: "2024-07-24",
        startTime: "14:00",
        endTime: "17:00",
        responsible: "Maria Oliveira",
        description: "Análise de cultura de tecidos"
      },
      {
        date: "2024-07-25",
        startTime: "10:00",
        endTime: "13:00",
        responsible: "Carlos Pereira",
        description: "Microscopia de células"
      }
    ];

    // Function to generate the calendar
    function generateCalendar() {
      const calendarBody = document.getElementById('calendar-body');
      calendarBody.innerHTML = '';

      const currentDate = new Date();
      let month = currentDate.getMonth() + 1;
      let year = currentDate.getFullYear();

      // Generate calendar for the current month
      for (let i = 1; i <= new Date(year, month, 0).getDate(); i++) {
        const dayOfWeek = new Date(year, month - 1, i).getDay();

        if (dayOfWeek === 0) {
          const row = document.createElement('tr');
          calendarBody.appendChild(row);
        }

        const cell = document.createElement('td');
        cell.textContent = i;
        cell.addEventListener('click', () => showEventDetails(i, month, year));

        // Check if there are any events on this day
        const eventElement = events.find(event => {
          const [eventYear, eventMonth, eventDay] = event.date.split('-');
          return parseInt(eventDay) === i && parseInt(eventMonth) === month && parseInt(eventYear) === year;
        });

        if (eventElement) {
          const eventDiv = document.createElement('div');
          eventDiv.classList.add('event');
          eventDiv.textContent = `${eventElement.responsible} - ${eventElement.startTime} - ${eventElement.endTime}`;
          eventDiv.setAttribute('data-date', `${year}-${month}-${i}`);
          cell.appendChild(eventDiv);
        }

        calendarBody.lastChild.appendChild(cell);
      }
    }

    // Function to show event details
    function showEventDetails(day, month, year) {
      const eventElement = document.querySelectorAll(".event[data-date='" + year + "-" + month + "-" + day + "']");
      
      if (eventElement.length > 0) {
        const event = events.find(e => e.date === year + "-" + month + "-" + day);
        
        document.getElementById("event-date").textContent = "Data: " + event.date;
        document.getElementById("event-start-time").textContent = "Início: " + event.startTime;
        document.getElementById("event-end-time").textContent = "Término: " + event.endTime;
        document.getElementById("event-responsible").textContent = "Responsável: " + event.responsible;
        document.getElementById("event-description").textContent = "Descrição: " + event.description;
        
        // Show the event details section
        document.getElementById("event-details").style.display = "block";
      } else {
        // Hide the event details section
        document.getElementById("event-details").style.display = "none";
      }
    }

    // Function to request a new event
    function requestNewEvent() {
      const requestDate = document.getElementById('request-date').value;
      const requestStartTime = document.getElementById('request-start-time').value;
      const requestEndTime = document.getElementById('request-end-time').value;
      const requestResponsible = document.getElementById('request-responsible').value;
      const requestDescription = document.getElementById('request-description').value;

      // Validate input
      if (!requestDate || !requestStartTime || !requestEndTime || !requestResponsible || !requestDescription) {
        alert('Por favor, preencha todos os campos.');
        return;
      }

      // Check if the requested date and time are available
      const existingEvent = events.find(event => {
        const [eventYear, eventMonth, eventDay] = event.date.split('-');
        return event.date === requestDate && (
          (event.startTime >= requestStartTime && event.startTime <= requestEndTime) ||
          (event.endTime >= requestStartTime && event.endTime <= requestEndTime)
        );
      });

      if (existingEvent) {
        alert('Horário já reservado. Por favor, selecione outro horário.');
        return;
      }

      // Add the new event to the events array
      events.push({
        date: requestDate,
        startTime: requestStartTime,
        endTime: requestEndTime,
        responsible: requestResponsible,
        description: requestDescription
      });

      // Clear the form
      document.getElementById('request-date').value = '';
      document.getElementById('request-start-time').value = '';
      document.getElementById('request-end-time').value = '';
      document.getElementById('request-responsible').value = '';
      document.getElementById('request-description').value = '';

      // Regenerate the calendar
      generateCalendar();
    }

    // Generate the initial calendar
    generateCalendar();
  </script>
</body>
</html>
